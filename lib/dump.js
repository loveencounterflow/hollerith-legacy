(function() {
  var $, CND, D, HOLLERITH, alert, badge, chrs, cli_options, db, debug, docopt, dump_settings, echo, filename, help, info, join, limit, log, new_db, njs_path, prefix, rpr, urge, usage, version, warn, whisper, ƒ;

  njs_path = require('path');

  join = njs_path.join;

  CND = require('cnd');

  rpr = CND.rpr;

  badge = 'HOLLERITH/dump';

  log = CND.get_logger('plain', badge);

  info = CND.get_logger('info', badge);

  whisper = CND.get_logger('whisper', badge);

  alert = CND.get_logger('alert', badge);

  debug = CND.get_logger('debug', badge);

  warn = CND.get_logger('warn', badge);

  help = CND.get_logger('help', badge);

  urge = CND.get_logger('urge', badge);

  echo = CND.echo.bind(CND);

  D = require('pipedreams2');

  $ = D.remit.bind(D);

  new_db = require('level');

  HOLLERITH = require('./main');

  ƒ = CND.format_number.bind(CND);

  this._first_chrs_of = function(text, n) {

    /*
    for text in [ 'abc', '中國皇帝', 'a𪜄b', ]
      for n in [ 0 .. 5 ]
        debug '©DLOTs', n, rpr prefix_of text, n
     */
    var count, idx, last_idx;
    if (n <= 0) {
      return '';
    }
    count = 0;
    idx = -1;
    last_idx = text.length - 1;
    while (count < n) {
      if (idx >= last_idx) {
        break;
      }
      idx += +1;
      if ((text.codePointAt(idx)) > 0xffff) {
        idx += +1;
      }
      count += 1;
    }
    return [text.slice(0, +idx + 1 || 9e9), idx + 1];
  };

  this._type_from_key = function(db, key) {
    var first, idx, phrasetype, ref, second;
    if (Array.isArray(key)) {
      if (!((3 <= (ref = key.length) && ref <= 4))) {
        throw new Error("illegal key: " + (rpr(key)));
      }
      phrasetype = key[0], first = key[1], second = key[2], idx = key[3];
      if (phrasetype !== 'so' && phrasetype !== 'os') {
        throw new Error("illegal phrasetype: " + (rpr(key)));
      }
      if (!((Array.isArray(first)) && first.length === 2)) {
        throw new Error("illegal key: " + (rpr(key)));
      }
      if (!((Array.isArray(second)) && second.length === 2)) {
        throw new Error("illegal key: " + (rpr(key)));
      }
      return 'list';
    }
    return 'other';
  };


  /* TAINT code duplication */

  this._$dump_keys = function(db, input, settings) {
    var chrs, colors, count, limit;
    limit = settings.limit, colors = settings.colors, chrs = settings.chrs;
    count = 0;
    return $((function(_this) {
      return function(key, send, end) {
        var key_rpr;
        if (key != null) {
          count += +1;
          if (count < limit) {
            key_rpr = HOLLERITH._rpr_of_key(db, HOLLERITH._decode(db, key));
            if (colors) {
              log(CND.grey(ƒ(count)), CND.plum(key_rpr), CND.grey(key.slice(0, 10)));
            } else {
              echo(ƒ(count), key);
            }
            send(key);
          }
          if (count >= limit) {
            input.emit('end');
          }
        }
        if (end != null) {
          help("dumped " + (ƒ(count)) + " entries");
          return process.exit();
        }
      };
    })(this));
  };


  /* TAINT code duplication */

  this._$dump_prefixes = function(db, input, settings) {
    var chrs, colors, key_count, limit, prefix_count, prefixes, t0;
    limit = settings.limit, colors = settings.colors, chrs = settings.chrs;
    key_count = 0;
    prefix_count = 0;
    prefixes = {};
    t0 = +new Date();
    return $((function(_this) {
      return function(key, send, end) {
        var dt, dt_min, dt_s, key_rpr, prefix, ref, suffix_idx, t1;
        if (key != null) {
          key_count += +1;
          if (key_count < limit) {
            key_rpr = HOLLERITH._rpr_of_key(db, HOLLERITH._decode(db, key));
            ref = _this._first_chrs_of(key_rpr, chrs), prefix = ref[0], suffix_idx = ref[1];
            if (prefixes[prefix] == null) {
              prefix_count += +1;
              prefixes[prefix] = 1;
              if (colors) {
                log(CND.grey(ƒ(key_count)), (CND.plum(prefix)) + (CND.grey(key_rpr.slice(suffix_idx))));
              } else {
                echo(ƒ(key_count), prefix, key_rpr.slice(suffix_idx));
              }
              send(key);
            }
          }
          if (key_count >= limit) {
            input.emit('end');
          }
        }
        if (end != null) {
          t1 = +new Date();
          dt = t1 - t0;
          dt_s = (dt / 1000).toFixed(3);
          dt_min = (dt / 60000).toFixed(1);
          help("dumped " + (ƒ(key_count)) + " entries in " + dt_s + "s (" + dt_min + "min)");
          help("found " + (ƒ(prefix_count)) + " distinct prefixes with up to " + (ƒ(chrs)) + " characters");
          return process.exit();
        }
      };
    })(this));
  };

  this.dump = function(db, settings) {
    var input, mode, prefix, query, worker;
    mode = settings.mode, prefix = settings.prefix;
    switch (settings['mode']) {
      case 'keys':
        if (prefix != null) {
          query = HOLLERITH._query_from_prefix(db, [prefix]);
          urge('©g1y6J', HOLLERITH._encode(db, [prefix]));
          urge('©g1y6J', query['gte']);
          urge('©g1y6J', query['lte']);
          input = db['%self'].createKeyStream(query);
        } else {
          input = db['%self'].createKeyStream();
        }
        worker = this._$dump_keys(db, input, settings);
        break;
      case 'prefixes':
        input = db['%self'].createKeyStream();
        worker = this._$dump_prefixes(db, input, settings);
        break;
      default:
        throw new Error("unknown mode " + (rpr(mode)));
    }
    return input.pipe(worker);
  };

  if (module.parent == null) {
    docopt = (require('coffeenode-docopt')).docopt;
    version = (require('../package.json'))['version'];
    filename = (require('path')).basename(__filename);
    usage = "Usage: " + filename + " <db-route> [--limit=N]\n       " + filename + " <db-route> ( [<prefix>] | keys [<prefix>] | prefixes [<chrs>] ) [--limit=N]\n\nOptions:\n  -l, --limit\n  -h, --help\n  -v, --version";

    /*
           #{filename} pos [--sample]
           #{filename} so [--db] [--limit] [--stdout] [<prefix>]
           #{filename} os [--db] [--limit] [--stdout] [<prefix>]
           #{filename} x
           #{filename} y
           #{filename} q <query0> [+|-] <query1>
           #{filename} sql
           #{filename} count
     */
    cli_options = docopt(usage, {
      version: version,
      help: function(left, collected) {
        urge(left);
        help(collected);
        help('\n' + usage);
        return process.exit();
      }
    });
    dump_settings = {
      limit: Infinity,
      mode: 'keys',
      colors: process.stdout.isTTY ? true : false,
      chrs: 3
    };
    dump_settings['route'] = join(__dirname, '..', cli_options['<db-route>']);
    if ((limit = cli_options['--limit'])) {
      dump_settings['limit'] = parseInt(limit, 10);
    }
    if (cli_options['prefixes']) {
      dump_settings['mode'] = 'prefixes';
    }
    if ((chrs = cli_options['<chrs>'])) {
      dump_settings['chrs'] = parseInt(chrs, 10);
    }
    if ((prefix = cli_options['<prefix>']) != null) {
      dump_settings['prefix'] = prefix;
    }
    db = HOLLERITH.new_db(dump_settings['route']);
    debug('©bEIeE', cli_options);
    help('©bEIeE', dump_settings);
    this.dump(db, dump_settings);
  }

}).call(this);

//# sourceMappingURL=data:application/json;base64,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QixhQUFlLENBQUEsT0FBQSxDQUFoQyxDQXpDTCxDQUFBO0FBQUEsSUEwQ0EsS0FBQSxDQUFNLFFBQU4sRUFBZ0IsV0FBaEIsQ0ExQ0EsQ0FBQTtBQUFBLElBMkNBLElBQUEsQ0FBSyxRQUFMLEVBQWUsYUFBZixDQTNDQSxDQUFBO0FBQUEsSUE0Q0EsSUFBQyxDQUFBLElBQUQsQ0FBTSxFQUFOLEVBQVUsYUFBVixDQTVDQSxDQUhGO0dBbEtBO0FBQUEiLCJmaWxlIjoiZHVtcC5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIlxuXG5cbiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xubmpzX3BhdGggICAgICAgICAgICAgICAgICA9IHJlcXVpcmUgJ3BhdGgnXG4jIG5qc19mcyAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlICdmcydcbmpvaW4gICAgICAgICAgICAgICAgICAgICAgPSBuanNfcGF0aC5qb2luXG4jLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cbkNORCAgICAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlICdjbmQnXG5ycHIgICAgICAgICAgICAgICAgICAgICAgID0gQ05ELnJwclxuYmFkZ2UgICAgICAgICAgICAgICAgICAgICA9ICdIT0xMRVJJVEgvZHVtcCdcbmxvZyAgICAgICAgICAgICAgICAgICAgICAgPSBDTkQuZ2V0X2xvZ2dlciAncGxhaW4nLCAgICAgYmFkZ2VcbmluZm8gICAgICAgICAgICAgICAgICAgICAgPSBDTkQuZ2V0X2xvZ2dlciAnaW5mbycsICAgICAgYmFkZ2VcbndoaXNwZXIgICAgICAgICAgICAgICAgICAgPSBDTkQuZ2V0X2xvZ2dlciAnd2hpc3BlcicsICAgYmFkZ2VcbmFsZXJ0ICAgICAgICAgICAgICAgICAgICAgPSBDTkQuZ2V0X2xvZ2dlciAnYWxlcnQnLCAgICAgYmFkZ2VcbmRlYnVnICAgICAgICAgICAgICAgICAgICAgPSBDTkQuZ2V0X2xvZ2dlciAnZGVidWcnLCAgICAgYmFkZ2Vcbndhcm4gICAgICAgICAgICAgICAgICAgICAgPSBDTkQuZ2V0X2xvZ2dlciAnd2FybicsICAgICAgYmFkZ2VcbmhlbHAgICAgICAgICAgICAgICAgICAgICAgPSBDTkQuZ2V0X2xvZ2dlciAnaGVscCcsICAgICAgYmFkZ2VcbnVyZ2UgICAgICAgICAgICAgICAgICAgICAgPSBDTkQuZ2V0X2xvZ2dlciAndXJnZScsICAgICAgYmFkZ2VcbmVjaG8gICAgICAgICAgICAgICAgICAgICAgPSBDTkQuZWNoby5iaW5kIENORFxuIy4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXG4jIGJ5dGV3aXNlICAgICAgICAgICAgICAgICAgPSByZXF1aXJlICdieXRld2lzZSdcbiMgdGhyb3VnaCAgICAgICAgICAgICAgICAgICA9IHJlcXVpcmUgJ3Rocm91Z2gyJ1xuIyBMZXZlbEJhdGNoICAgICAgICAgICAgICAgID0gcmVxdWlyZSAnbGV2ZWwtYmF0Y2gtc3RyZWFtJ1xuIyBCYXRjaFN0cmVhbSAgICAgICAgICAgICAgID0gcmVxdWlyZSAnYmF0Y2gtc3RyZWFtJ1xuIyBwYXJhbGxlbCAgICAgICAgICAgICAgICAgID0gcmVxdWlyZSAnY29uY3VycmVudC13cml0YWJsZSdcbkQgICAgICAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlICdwaXBlZHJlYW1zMidcbiQgICAgICAgICAgICAgICAgICAgICAgICAgPSBELnJlbWl0LmJpbmQgRFxuIy4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXG5uZXdfZGIgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZSAnbGV2ZWwnXG4jIG5ld19sZXZlbGdyYXBoICAgICAgICAgICAgPSByZXF1aXJlICdsZXZlbGdyYXBoJ1xuIyBkYiAgICAgICAgICAgICAgICAgICAgICAgID0gbmV3X2xldmVsZ3JhcGggJy90bXAvbGV2ZWxncmFwaCdcbkhPTExFUklUSCAgICAgICAgICAgICAgICAgPSByZXF1aXJlICcuL21haW4nXG7GkiAgICAgICAgICAgICAgICAgICAgICAgICA9IENORC5mb3JtYXRfbnVtYmVyLmJpbmQgQ05EXG5cbiMgJ0AnXG5cbiMgYmF0Y2hlZF9kYiAgPSBuZXcgTGV2ZWxCYXRjaCBsZXZlbF9kYlxuIyBpbnB1dCAgICAgICA9IEQuY3JlYXRlX3Rocm91Z2hzdHJlYW0oKVxuXG5cbiMgaW5wdXRcbiMgICAucGlwZSAkICgga2V5LCBzZW5kICkgPT5cbiMgICAgIHNlbmQgeyB0eXBlOiAncHV0Jywga2V5OiBrZXksIHZhbHVlOiAxLCB9XG4jICAgLnBpcGUgbmV3IEJhdGNoU3RyZWFtIHNpemU6IDEwMFxuIyAgIC5waXBlIHBhcmFsbGVsIGJhdGNoZWRfZGIsIDEwXG5cblxuIyB0cmlwbGUgPSB7IHN1YmplY3Q6IFwi5pytXCIsIHByZWRpY2F0ZTogXCJzdHJva2VvcmRlcjo6Zm9vYmFyXCIsIG9iamVjdDogXCIxMjM0NVwiIH1cbiMgZGIucHV0IHRyaXBsZSwgKCBlcnJvciApIC0+XG4jICAgdGhyb3cgZXJyb3IgaWYgZXJyb3I/XG5cblxuIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AX2ZpcnN0X2NocnNfb2YgPSAoIHRleHQsIG4gKSAtPlxuICAjIyNcbiAgZm9yIHRleHQgaW4gWyAnYWJjJywgJ+S4reWci+eah+W4nScsICdh8KqchGInLCBdXG4gICAgZm9yIG4gaW4gWyAwIC4uIDUgXVxuICAgICAgZGVidWcgJ8KpRExPVHMnLCBuLCBycHIgcHJlZml4X29mIHRleHQsIG5cbiAgIyMjXG4gIHJldHVybiAnJyBpZiBuIDw9IDBcbiAgY291bnQgICAgID0gMFxuICBpZHggICAgICAgPSAtMVxuICBsYXN0X2lkeCAgPSB0ZXh0Lmxlbmd0aCAtIDFcbiAgd2hpbGUgY291bnQgPCBuXG4gICAgYnJlYWsgaWYgaWR4ID49IGxhc3RfaWR4XG4gICAgaWR4ICAgICs9ICsxXG4gICAgaWR4ICAgICs9ICsxIGlmICggdGV4dC5jb2RlUG9pbnRBdCBpZHggKSA+IDB4ZmZmZlxuICAgIGNvdW50ICArPSAxXG4gIHJldHVybiBbIHRleHRbIC4uIGlkeCBdLCBpZHggKyAxLCBdXG5cbiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuQF90eXBlX2Zyb21fa2V5ID0gKCBkYiwga2V5ICkgLT5cbiAgaWYgQXJyYXkuaXNBcnJheSBrZXlcbiAgICB0aHJvdyBuZXcgRXJyb3IgXCJpbGxlZ2FsIGtleTogI3tycHIga2V5fVwiIHVubGVzcyAzIDw9IGtleS5sZW5ndGggPD0gNFxuICAgIFsgcGhyYXNldHlwZSwgZmlyc3QsIHNlY29uZCwgaWR4LCBdID0ga2V5XG4gICAgdGhyb3cgbmV3IEVycm9yIFwiaWxsZWdhbCBwaHJhc2V0eXBlOiAje3JwciBrZXl9XCIgdW5sZXNzIHBocmFzZXR5cGUgaW4gWyAnc28nLCAnb3MnLCBdXG4gICAgdGhyb3cgbmV3IEVycm9yIFwiaWxsZWdhbCBrZXk6ICN7cnByIGtleX1cIiB1bmxlc3MgKCBBcnJheS5pc0FycmF5IGZpcnN0ICApIGFuZCAgZmlyc3QubGVuZ3RoIGlzIDJcbiAgICB0aHJvdyBuZXcgRXJyb3IgXCJpbGxlZ2FsIGtleTogI3tycHIga2V5fVwiIHVubGVzcyAoIEFycmF5LmlzQXJyYXkgc2Vjb25kICkgYW5kIHNlY29uZC5sZW5ndGggaXMgMlxuICAgIHJldHVybiAnbGlzdCdcbiAgcmV0dXJuICdvdGhlcidcblxuIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4jIyMgVEFJTlQgY29kZSBkdXBsaWNhdGlvbiAjIyNcbkBfJGR1bXBfa2V5cyA9ICggZGIsIGlucHV0LCBzZXR0aW5ncyApIC0+XG4gIHsgbGltaXQsIGNvbG9ycywgY2hycywgfSA9IHNldHRpbmdzXG4gIGNvdW50ICAgICA9IDBcbiAgIy4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxuICByZXR1cm4gJCAoIGtleSwgc2VuZCwgZW5kICkgPT5cbiAgICAjLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxuICAgIGlmIGtleT9cbiAgICAgIGNvdW50ICs9ICsxXG4gICAgICBpZiBjb3VudCA8IGxpbWl0XG4gICAgICAgIGtleV9ycHIgPSBIT0xMRVJJVEguX3Jwcl9vZl9rZXkgZGIsIEhPTExFUklUSC5fZGVjb2RlIGRiLCBrZXlcbiAgICAgICAgaWYgY29sb3JzXG4gICAgICAgICAgbG9nICggQ05ELmdyZXkgxpIgY291bnQgKSwgKCBDTkQucGx1bSBrZXlfcnByICksICggQ05ELmdyZXkga2V5LnNsaWNlIDAsIDEwIClcbiAgICAgICAgZWxzZVxuICAgICAgICAgIGVjaG8gKCDGkiBjb3VudCApLCBrZXlcbiAgICAgICAgc2VuZCBrZXlcbiAgICAgICMuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxuICAgICAgaW5wdXQuZW1pdCAnZW5kJyBpZiBjb3VudCA+PSBsaW1pdFxuICAgICMuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXG4gICAgaWYgZW5kP1xuICAgICAgaGVscCBcImR1bXBlZCAje8aSIGNvdW50fSBlbnRyaWVzXCJcbiAgICAgIHByb2Nlc3MuZXhpdCgpXG5cbiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyMjIFRBSU5UIGNvZGUgZHVwbGljYXRpb24gIyMjXG5AXyRkdW1wX3ByZWZpeGVzID0gKCBkYiwgaW5wdXQsIHNldHRpbmdzICkgLT5cbiAgeyBsaW1pdCwgY29sb3JzLCBjaHJzLCB9ID0gc2V0dGluZ3NcbiAga2V5X2NvdW50ICAgICA9IDBcbiAgcHJlZml4X2NvdW50ICA9IDBcbiAgcHJlZml4ZXMgICAgICA9IHt9XG4gIHQwICAgICAgICAgICAgPSArbmV3IERhdGUoKVxuICAjLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXG4gIHJldHVybiAkICgga2V5LCBzZW5kLCBlbmQgKSA9PlxuICAgICMuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXG4gICAgaWYga2V5P1xuICAgICAga2V5X2NvdW50ICs9ICsxXG4gICAgICBpZiBrZXlfY291bnQgPCBsaW1pdFxuICAgICAgICBrZXlfcnByID0gSE9MTEVSSVRILl9ycHJfb2Zfa2V5IGRiLCBIT0xMRVJJVEguX2RlY29kZSBkYiwga2V5XG4gICAgICAgIFsgcHJlZml4LCBzdWZmaXhfaWR4LCBdID0gQF9maXJzdF9jaHJzX29mIGtleV9ycHIsIGNocnNcbiAgICAgICAgdW5sZXNzIHByZWZpeGVzWyBwcmVmaXggXT9cbiAgICAgICAgICBwcmVmaXhfY291bnQgICAgICAgKz0gKzFcbiAgICAgICAgICBwcmVmaXhlc1sgcHJlZml4IF0gID0gMVxuICAgICAgICAgIGlmIGNvbG9yc1xuICAgICAgICAgICAgbG9nICggQ05ELmdyZXkgxpIga2V5X2NvdW50ICksICggQ05ELnBsdW0gcHJlZml4ICkgKyAoIENORC5ncmV5IGtleV9ycHJbIHN1ZmZpeF9pZHggLi4gXSApXG4gICAgICAgICAgZWxzZVxuICAgICAgICAgICAgZWNobyAoIMaSIGtleV9jb3VudCApLCBwcmVmaXgsIGtleV9ycHJbIHN1ZmZpeF9pZHggLi4gXVxuICAgICAgICAgIHNlbmQga2V5XG4gICAgICAjLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cbiAgICAgIGlucHV0LmVtaXQgJ2VuZCcgaWYga2V5X2NvdW50ID49IGxpbWl0XG4gICAgIy4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cbiAgICBpZiBlbmQ/XG4gICAgICB0MSAgICAgID0gK25ldyBEYXRlKClcbiAgICAgIGR0ICAgICAgPSB0MSAtIHQwXG4gICAgICBkdF9zICAgID0gKCBkdCAvICAxMDAwICkudG9GaXhlZCAzXG4gICAgICBkdF9taW4gID0gKCBkdCAvIDYwMDAwICkudG9GaXhlZCAxXG4gICAgICBoZWxwIFwiZHVtcGVkICN7xpIga2V5X2NvdW50fSBlbnRyaWVzIGluICN7ZHRfc31zICgje2R0X21pbn1taW4pXCJcbiAgICAgIGhlbHAgXCJmb3VuZCAje8aSIHByZWZpeF9jb3VudH0gZGlzdGluY3QgcHJlZml4ZXMgd2l0aCB1cCB0byAje8aSIGNocnN9IGNoYXJhY3RlcnNcIlxuICAgICAgcHJvY2Vzcy5leGl0KClcblxuIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5AZHVtcCA9ICggZGIsIHNldHRpbmdzICkgLT5cbiAgeyBtb2RlLCBwcmVmaXgsIH0gPSBzZXR0aW5nc1xuICBzd2l0Y2ggc2V0dGluZ3NbICdtb2RlJyBdXG4gICAgd2hlbiAna2V5cydcbiAgICAgIGlmIHByZWZpeD9cbiAgICAgICAgcXVlcnkgPSBIT0xMRVJJVEguX3F1ZXJ5X2Zyb21fcHJlZml4IGRiLCBbIHByZWZpeCwgXVxuICAgICAgICAjIHF1ZXJ5ID0geyBndGU6ICggSE9MTEVSSVRILl9lbmNvZGUgZGIsIFsgcHJlZml4LCBdICksIGx0ZTogKCBIT0xMRVJJVEguX2VuY29kZSBkYiwgWyBwcmVmaXgsIHVuZGVmaW5lZCwgXSApLCB9XG4gICAgICAgIHVyZ2UgJ8KpZzF5NkonLCBIT0xMRVJJVEguX2VuY29kZSBkYiwgWyBwcmVmaXgsIF1cbiAgICAgICAgdXJnZSAnwqlnMXk2SicsIHF1ZXJ5WyAnZ3RlJyBdXG4gICAgICAgIHVyZ2UgJ8KpZzF5NkonLCBxdWVyeVsgJ2x0ZScgXVxuICAgICAgICBpbnB1dCA9IGRiWyAnJXNlbGYnIF0uY3JlYXRlS2V5U3RyZWFtIHF1ZXJ5XG4gICAgICBlbHNlXG4gICAgICAgIGlucHV0ID0gZGJbICclc2VsZicgXS5jcmVhdGVLZXlTdHJlYW0oKVxuICAgICAgd29ya2VyICA9IEBfJGR1bXBfa2V5cyBkYiwgaW5wdXQsIHNldHRpbmdzXG4gICAgd2hlbiAncHJlZml4ZXMnXG4gICAgICBpbnB1dCAgID0gZGJbICclc2VsZicgXS5jcmVhdGVLZXlTdHJlYW0oKVxuICAgICAgd29ya2VyICA9IEBfJGR1bXBfcHJlZml4ZXMgZGIsIGlucHV0LCBzZXR0aW5nc1xuICAgIGVsc2UgdGhyb3cgbmV3IEVycm9yIFwidW5rbm93biBtb2RlICN7cnByIG1vZGV9XCJcbiAgaW5wdXRcbiAgICAucGlwZSB3b3JrZXJcblxuXG4jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcbnVubGVzcyBtb2R1bGUucGFyZW50P1xuXG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgZG9jb3B0ICAgID0gKCByZXF1aXJlICdjb2ZmZWVub2RlLWRvY29wdCcgKS5kb2NvcHRcbiAgdmVyc2lvbiAgID0gKCByZXF1aXJlICcuLi9wYWNrYWdlLmpzb24nIClbICd2ZXJzaW9uJyBdXG4gIGZpbGVuYW1lICA9ICggcmVxdWlyZSAncGF0aCcgKS5iYXNlbmFtZSBfX2ZpbGVuYW1lXG4gICAgICAgICAjICN7ZmlsZW5hbWV9IHBvcyBbLS1zYW1wbGVdIFs8cHJlZml4Pl1cbiAgdXNhZ2UgICAgID0gXCJcIlwiXG4gIFVzYWdlOiAje2ZpbGVuYW1lfSA8ZGItcm91dGU+IFstLWxpbWl0PU5dXG4gICAgICAgICAje2ZpbGVuYW1lfSA8ZGItcm91dGU+ICggWzxwcmVmaXg+XSB8IGtleXMgWzxwcmVmaXg+XSB8IHByZWZpeGVzIFs8Y2hycz5dICkgWy0tbGltaXQ9Tl1cblxuICBPcHRpb25zOlxuICAgIC1sLCAtLWxpbWl0XG4gICAgLWgsIC0taGVscFxuICAgIC12LCAtLXZlcnNpb25cbiAgXCJcIlwiXG4gICMjI1xuICAgICAgICAgI3tmaWxlbmFtZX0gcG9zIFstLXNhbXBsZV1cbiAgICAgICAgICN7ZmlsZW5hbWV9IHNvIFstLWRiXSBbLS1saW1pdF0gWy0tc3Rkb3V0XSBbPHByZWZpeD5dXG4gICAgICAgICAje2ZpbGVuYW1lfSBvcyBbLS1kYl0gWy0tbGltaXRdIFstLXN0ZG91dF0gWzxwcmVmaXg+XVxuICAgICAgICAgI3tmaWxlbmFtZX0geFxuICAgICAgICAgI3tmaWxlbmFtZX0geVxuICAgICAgICAgI3tmaWxlbmFtZX0gcSA8cXVlcnkwPiBbK3wtXSA8cXVlcnkxPlxuICAgICAgICAgI3tmaWxlbmFtZX0gc3FsXG4gICAgICAgICAje2ZpbGVuYW1lfSBjb3VudFxuICAjIyNcbiAgY2xpX29wdGlvbnMgPSBkb2NvcHQgdXNhZ2UsIHZlcnNpb246IHZlcnNpb24sIGhlbHA6ICggbGVmdCwgY29sbGVjdGVkICkgLT5cbiAgICB1cmdlIGxlZnRcbiAgICBoZWxwIGNvbGxlY3RlZFxuICAgIGhlbHAgJ1xcbicgKyB1c2FnZVxuICAgIHByb2Nlc3MuZXhpdCgpXG4gICMuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cbiAgZHVtcF9zZXR0aW5ncyA9XG4gICAgbGltaXQ6ICAgICAgICAgICAgSW5maW5pdHlcbiAgICBtb2RlOiAgICAgICAgICAgICAna2V5cydcbiAgICBjb2xvcnM6ICAgICAgICAgICBpZiBwcm9jZXNzLnN0ZG91dC5pc1RUWSB0aGVuIHRydWUgZWxzZSBmYWxzZVxuICAgIGNocnM6ICAgICAgICAgICAgIDNcbiAgIy4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxuICBkdW1wX3NldHRpbmdzWyAncm91dGUnICAgIF0gPSBqb2luIF9fZGlybmFtZSwgJy4uJywgY2xpX29wdGlvbnNbICc8ZGItcm91dGU+JyBdXG4gIGR1bXBfc2V0dGluZ3NbICdsaW1pdCcgICAgXSA9ICggcGFyc2VJbnQgbGltaXQsIDEwICkgaWYgKCBsaW1pdCA9IGNsaV9vcHRpb25zWyAnLS1saW1pdCcgXSApXG4gIGR1bXBfc2V0dGluZ3NbICdtb2RlJyAgICAgXSA9ICdwcmVmaXhlcycgaWYgY2xpX29wdGlvbnNbICdwcmVmaXhlcycgXVxuICBkdW1wX3NldHRpbmdzWyAnY2hycycgICAgIF0gPSAoIHBhcnNlSW50ICBjaHJzLCAxMCApIGlmICggIGNocnMgPSBjbGlfb3B0aW9uc1sgICc8Y2hycz4nIF0gKVxuICBkdW1wX3NldHRpbmdzWyAncHJlZml4JyAgIF0gPSBwcmVmaXggaWYgKCBwcmVmaXggPSBjbGlfb3B0aW9uc1sgJzxwcmVmaXg+JyBdICk/XG4gICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgZGIgPSBIT0xMRVJJVEgubmV3X2RiIGR1bXBfc2V0dGluZ3NbICdyb3V0ZScgXVxuICBkZWJ1ZyAnwqliRUllRScsIGNsaV9vcHRpb25zXG4gIGhlbHAgJ8KpYkVJZUUnLCBkdW1wX3NldHRpbmdzXG4gIEBkdW1wIGRiLCBkdW1wX3NldHRpbmdzXG5cbiAgIyBkZWJ1ZyAnwqlsSjhuYicsIEhPTExFUklUSC5fZW5jb2RlIG51bGwsIDFcbiAgIyBkZWJ1ZyAnwqlsSjhuYicsIEhPTExFUklUSC5fZW5jb2RlIG51bGwsIFsgMSwgXVxuICAjIGRlYnVnICfCqWxKOG5iJywgSE9MTEVSSVRILl9lbmNvZGUgbnVsbCwgWyAxLCB1bmRlZmluZWQsIF1cbiAgIyBsb2coKVxuICAjIGRlYnVnICfCqWxKOG5iJywgSE9MTEVSSVRILl9lbmNvZGUgbnVsbCwgJzEnXG4gICMgZGVidWcgJ8KpbEo4bmInLCBIT0xMRVJJVEguX2VuY29kZSBudWxsLCBbICcxJywgXVxuICAjIGRlYnVnICfCqWxKOG5iJywgSE9MTEVSSVRILl9xdWVyeV9mcm9tX3ByZWZpeCBudWxsLCAxXG4gICMgZGVidWcgJ8KpbEo4bmInLCBIT0xMRVJJVEguX3F1ZXJ5X2Zyb21fcHJlZml4IG51bGwsIFsgMSwgXVxuICAjIGRlYnVnICfCqWxKOG5iJywgSE9MTEVSSVRILl9xdWVyeV9mcm9tX3ByZWZpeCBudWxsLCAnMSdcbiAgIyBkZWJ1ZyAnwqlsSjhuYicsIEhPTExFUklUSC5fcXVlcnlfZnJvbV9wcmVmaXggbnVsbCwgWyAnMScsIF1cbiAgIyBkZWJ1ZyAnwqlsSjhuYicsIEhPTExFUklUSC5fZW5jb2RlIG51bGwsICdcXHgwMCdcbiAgIyBkZWJ1ZyAnwqlsSjhuYicsIEhPTExFUklUSC5fZW5jb2RlIG51bGwsICdcXHgwMSdcbiAgIyBkZWJ1ZyAnwqlsSjhuYicsIEhPTExFUklUSC5fZW5jb2RlIG51bGwsICdcXHgwMidcbiAgIyBsb2coKVxuXG4gICMgZm9yIGNpZCBpbiBbIDB4MDAgLi4gMHhmZiBdXG4gICMgICBkZWJ1ZyAnwqlsSjhuYicsICggJzB4JyArICggaWYgY2lkIDw9IDB4ZiB0aGVuICcwJyBlbHNlICcnICkgKyBjaWQudG9TdHJpbmcgMTYgKSwgSE9MTEVSSVRILl9lbmNvZGUgbnVsbCwgWyBTdHJpbmcuZnJvbUNvZGVQb2ludCBjaWQsIF1cbiAgIyBkZWJ1ZyAnwql2ZmtreCcsIEhPTExFUklUSC5fZGVjb2RlIG51bGwsIEhPTExFUklUSC5lbmNvZGUgbnVsbCwgK0luZmluaXR5XG4gICMgZGVidWcgJ8KpdmZra3gnLCBIT0xMRVJJVEguX2RlY29kZSBudWxsLCBIT0xMRVJJVEguZW5jb2RlIG51bGwsIC1JbmZpbml0eVxuICAjIGRlYnVnICfCqXZma2t4JywgSE9MTEVSSVRILl9kZWNvZGUgbnVsbCwgSE9MTEVSSVRILmVuY29kZSBudWxsLCBudWxsXG4gICMgZGVidWcgJ8KpdmZra3gnLCBIT0xMRVJJVEguX2RlY29kZSBudWxsLCBIT0xMRVJJVEguZW5jb2RlIG51bGwsIHVuZGVmaW5lZFxuICAjIENORC5saXN0ZW5fdG9fa2V5cyAoIFAuLi4gKSAtPlxuICAjICAgZGVidWcgJ8KpV09tbGonLCBQXG4gICMgcHJvY2Vzcy5zdGRpbi5yZXN1bWUoKVxuXG4gICMgZm9yIHRleHQgaW4gWyAnYWJjJywgJ+S4reWci+eah+W4nScsICdh8KqchGInLCBdXG4gICMgICBmb3IgbiBpbiBbIDAgLi4gNSBdXG4gICMgICAgIGRlYnVnICfCqURMT1RzJywgbiwgcnByIEBfZmlyc3RfY2hyc19vZiB0ZXh0LCBuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4iXX0=